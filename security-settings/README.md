                                                              SECURITY SETTINGS
 
 
 
  
                                                 Политики логирования по умолчанию и аудиты.
                                                     
В Windows 7 (и выше(насчёт ниже хз)) присутсвует встроенный "Журнал событий" (можно вызвать через "Выполнить" фразой:'eventvwr'). В нём имеются журналы событий безопасности 
(и других событий). В настройках можно настроить количество памяти занимаемое логами, при переполнении объёма, старые события будут удаляться и 
перезаписываться новыми событиями. 

Логи безопасности через Windows PowerShell:    
Командой Get-EventLog security можно получить список событий безопасности в PowerShell

Логи PowerShell стоит использовать вместе с Журналом событий




Также в Windows можно расширить встроенный аудит (который по-умолчанию отключен) вводим в "Выполнить"
вот этот запрос:'secpol.msc' 

Идём по пути:

Параметры безопасности -> Локальные политики -> Политика аудита. Там есть встроенные аудиты. Если мы хотим расширенные настройки,
то идём по-такому пути

Параметры безопасности -> Конфигурация расширенной политики аудита -> Политики аудита системы - Объект локальной групповой политики.

Здесь и будут расширенные настройки. В общей сложности 10 политик и 60 подкатегорий. Рассмотрим интересующие нас.

У каждого аудита есть описание.

Наиболее полезные для нас политики аудита системы:

Аудит управление учётными записями:

1. Аудит управления учётными записями пользователей.    
Благодаря этому аудиту, мы сможем узнать о всех изменениях вносимые в учётные записи пользователей (изменение паролей, прав)

Аудит подробного отслеживания:

1. Аудит активности DPAPI.  

Этот параметр политики обеспечивает аудит событий, которые возникают при запросах на шифрование или расшифровку к интерфейсу приложений защиты данных (DPAPI).
Интерфейс DPAPI используется для защиты конфиденциальных данных, например паролей и ключей.

2. Аудит создания процессов.  
Этот параметр политики обеспечивает аудит событий, возникающих при создании или запуске процесса. 
Также осуществляется аудит имени пользователя или приложения, создавшего процесс.

Аудит доступа к объектам:

1. Аудит сведений об общем файловом ресурсу.   
Этот параметр политики позволяет вести аудит попыток доступа к файлам и папкам в общих папках. 
Параметр позволяет протоколировать события при любой попытке обращения к файлу или папке

2. Аудит других событий доступа к объектам.     
Этот параметр политики обеспечивает аудит событий, возникающих при управлении заданиями планировщика задач или объектами COM+.

3. Аудит реестра.   
Этот параметр политики обеспечивает аудит попыток доступа к объектам реестра.

Аудит изменения политки:

1. Аудит изменения политики аудита.    
Этот параметр политики позволяет вести аудит изменений параметров политики аудита безопасности.

2. Аудит изменения политики проверки подлинности.     
Этот параметр политики позволяет вести аудит событий, возникающих при выполнении изменений групп безопасности

3. Аудит изменения политки авторизации.    
Этот параметр политики позволяет вести аудит событий, возникающих при выполнении изменений политики авторизации

4. Аудит изменения политики на уровне правил MPSSVC.    
Этот параметр политики позволяет вести аудит событий, возникающих при изменении правил политики, используемых службой защиты Майкрософт (MPSSVC). 
Эта служба используется брандмауэром Windows

Аудит использования привилегий:

1. Аудит использования привилегий, не затрагивающих конфиденциальные данные.    
Этот параметр политики обеспечивает аудит событий, возникающих при использовании привилегий, не затрагивающих конфиденциальные данные (права пользователя).

2. Аудит использования привилегий, затрагивающих конфиденциальные данные. 
Этот параметр политики обеспечивает аудит событий, возникающих при использовании прав, затрагивающем конфиденциальные данные (пользовательских прав)

Аудит системы:

1. Аудит других системных событий.    
Этот параметр политики позволяет вести аудит следующих событий:    
	Запуск и завершение работы службы и драйвера брандмауэра Windows.     
	Обработка политики безопасности службой брандмауэра Windows.    
	Операции с файлами ключей шифрования и операции миграции.       
  
2. Аудит расширения системы безопасности.    
Этот параметр политики позволяет вести аудит событий, связанных с расширением системы безопасности, таких как следующие:   
	Загрузка расширения системы безопасности, например, пакета проверки подлинности, уведомления или безопасности, и его регистрация в системе администратора локальной безопасности (LSA). 
  Оно используется для проверки подлинности при попытке входа, отправки запросов на вход в систему, а также при любых изменениях учетных записей или паролей. 
  Примерами расширений системы безопасности являются Kerberos и NTLM.     
	Установка и регистрация службы в диспетчере управления службами. В журнале аудита регистрируются сведения об имени, двоичных файлах, типе, типе запуска и учетной записи службы



                                                        SYSMON
                                                        
Sysmon - официальная утилита от Microsoft, созданная с целью, облегчения анализа атака и увеличение информации в логах. К примеру: 
Основной проблемой работы с журналом событий Windows является отсутствие информации о родительских процессах, т.е. из него нельзя понять иерархию процессов.
В записях лога Sysmon же наоборот, содержатся идентификатор процесса родителя, его имя и запускаемая командная строка.

  Полезные детали которых нет в журнале событий, но есть в Sysmon:

ID процесса (в десятичной форме, а не hex!)                
ID родительского процесса                        
Командная строка процесса     
Командная строка родительского процесса          
Хэш образа файла         
Имена образов файла       














                                                    
 
